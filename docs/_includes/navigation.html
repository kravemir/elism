{% comment %} Source: https://gist.github.com/kasperisager/9416313 {% endcomment %}
{% capture html %}
<ul>
    {% if include.context == "/" %}
    <li class="root {% if page.url == "/" %}active{% endif %}">
    <a href="{{ site.baseurl }}/">{{ site.title }}</a>
    </li>
    {% endif %}

    {% assign entries = site.pages | sort: "path" %}
    {% for entry in entries %}

    {% capture slug    %}{{ entry.url | split: "/"   | last                       }}{% endcapture %}
    {% capture current %}{{ entry.url | remove: slug | replace: "//", "/" | append: "/" | replace: "//", "/" }}{% endcapture %}

    {% if current == include.context and entry.url != include.context and entry.title %}
    <li class="{% if page.url == entry.url %}active{% endif %}">
        <a href="{{ site.baseurl }}{{ entry.url }}">{{ entry.title }}</a>
        {% if page.url contains entry.url %}
            {% include navigation.html context=entry.url %}
        {% endif %}
    </li>
    {% endif %}

    {% endfor %}
</ul>
{% endcapture %}{{ html | strip_newlines | replace:'    ','' | replace:'    ','' | replace:'  ',' ' }}